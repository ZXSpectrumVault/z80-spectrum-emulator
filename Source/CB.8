EMULATOR SEGMENT BYTE PUBLIC

;Alle blokjes hebben offset 02D. Als dit veranderd wordt, kijk ook naar
; de aanroepen van MOVECOMMAND in Z80.8

;Timing: All instructions take 8 T cycles, except those that operate
;on (HL) which take 15 T cycles, EXCEPT the bit n,(hl)'s, which take 12.

testcboverf macro
        ##if !(($ - emulate -04c) and 080)
        This will make A86 generate an error message
        ##endif
#em

        ORG (0 SHL 8)+02D
        SAHF
        ROL CH,1
        lahf
        TEST CH,CH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (1 SHL 8)+02D
        SAHF
        ROL CL,1
        lahf
        TEST CL,CL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (2 SHL 8)+02D
        SAHF
        XCHG BX,SI
        ROL BH,1
        lahf
        TEST BH
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (3 SHL 8)+02D
        SAHF
        XCHG BX,SI
        ROL BL,1
        lahf
        TEST BL
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (4 SHL 8)+02D
        SAHF
        ROL DH,1
        lahf
        TEST DH,DH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (5 SHL 8)+02D
        SAHF
        ROL DL,1
        lahf
        TEST DL,DL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (6 SHL 8)+02D
        SAHF
        MOV BX,DX
        mov ah,[bx]
        ROL ah,1
        IF C JMP CARBX
        jmp pokebx

        testcboverf
        ORG (7 SHL 8)+02D
        SAHF
        ROL AL,1
        lahf
        TEST AL,AL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (8 SHL 8)+02D
        SAHF
        ROR CH,1
        lahf
        TEST CH,CH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (9 SHL 8)+02D
        SAHF
        ROR CL,1
        lahf
        TEST CL,CL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (10 SHL 8)+02D
        SAHF
        XCHG BX,SI
        ROR BH,1
        lahf
        TEST BH
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (11 SHL 8)+02D
        SAHF
        XCHG BX,SI
        ROR BL,1
        lahf
        TEST BL
        ror ah,1
        LAHF
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (12 SHL 8)+02D
        SAHF
        ROR DH,1
        lahf
        TEST DH,DH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (13 SHL 8)+02D
        SAHF
        ROR DL,1
        lahf
        TEST DL,DL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (14 SHL 8)+02D
        SAHF
        MOV BX,DX
        mov ah,[bx]
        ROR ah,1
        IF C JMP CARBX
        jmp pokebx

        testcboverf
        ORG (15 SHL 8)+02D
        SAHF
        ROR AL,1
        lahf
        TEST AL,AL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (16 SHL 8)+02D
        SAHF
        RCL CH,1
        lahf
        TEST CH,CH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (17 SHL 8)+02D
        SAHF
        RCL CL,1
        lahf
        TEST CL,CL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (18 SHL 8)+02D
        SAHF
        XCHG BX,SI
        RCL BH,1
        lahf
        TEST BH
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (19 SHL 8)+02D
        SAHF
        XCHG BX,SI
        RCL BL,1
        lahf
        TEST BL
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (20 SHL 8)+02D
        SAHF
        RCL DH,1
        lahf
        TEST DH,DH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (21 SHL 8)+02D
        SAHF
        RCL DL,1
        lahf
        TEST DL,DL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (22 SHL 8)+02D
        SAHF
        MOV BX,DX
        mov ah,[bx]
        RCL ah,1
        IF C JMP CARBX
        jmp pokebx

        testcboverf
        ORG (23 SHL 8)+02D
        SAHF
        RCL AL,1
        lahf
        TEST AL,AL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (24 SHL 8)+02D
        SAHF
        RCR CH,1
        lahf
        TEST CH,CH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (25 SHL 8)+02D
        SAHF
        RCR CL,1
        lahf
        TEST CL,CL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (26 SHL 8)+02D
        SAHF
        XCHG BX,SI
        RCR BH,1
        lahf
        TEST BH
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (27 SHL 8)+02D
        SAHF
        XCHG BX,SI
        RCR BL,1
        lahf
        TEST BL
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (28 SHL 8)+02D
        SAHF
        RCR DH,1
        lahf
        TEST DH,DH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (29 SHL 8)+02D
        SAHF
        RCR DL,1
        lahf
        TEST DL,DL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (30 SHL 8)+02D
        SAHF
        MOV BX,DX
        mov ah,[bx]
        RCR ah,1
        IF C JMP CARBX
        jmp pokebx

        testcboverf
        ORG (31 SHL 8)+02D
        SAHF
        RCR AL,1
        lahf
        TEST AL,AL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (32 SHL 8)+02D
        SAHF
        SAL CH,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (33 SHL 8)+02D
        SAHF
        SAL CL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (34 SHL 8)+02D
        SAHF
        XCHG BX,SI
        SAL BH,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (35 SHL 8)+02D
        SAHF
        XCHG BX,SI
        SAL BL,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (36 SHL 8)+02D
        SAHF
        SAL DH,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (37 SHL 8)+02D
        SAHF
        SAL DL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (38 SHL 8)+02D
        mov bx,dx
        call testbx                     ; ***** HMc *****
        if nc jmp salrom                ; ***** HMc *****
        SAHF
        mov ah,[bx]
        sal ah,1
        if c jmp carbx
        jmp pokebx

        testcboverf
        ORG (39 SHL 8)+02D
        SAHF
        SAL AL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (40 SHL 8)+02D
        SAHF
        SAR CH,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (41 SHL 8)+02D
        SAHF
        SAR CL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (42 SHL 8)+02D
        SAHF
        XCHG BX,SI
        SAR BH,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (43 SHL 8)+02D
        SAHF
        XCHG BX,SI
        SAR BL,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (44 SHL 8)+02D
        SAHF
        SAR DH,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (45 SHL 8)+02D
        SAHF
        SAR DL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (46 SHL 8)+02D
        mov bx,dx
        call testbx                     ; ***** HMc *****
        if nc jmp sarrom                ; ***** HMc *****
        SAHF
        mov ah,[bx]
        sar ah,1
        if c jmp carbx
        jmp pokebx

        testcboverf
        ORG (47 SHL 8)+02D
        SAHF
        SAR AL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (48 SHL 8)+02D
        SAHF                            ; 5: onofficiele instructie
        stc                             ;SLL (Shift Left Logical)
        rcl CH,1                        ;met als 'quirk': bit 0 wordt 1!
        lahf                            ; (bounder en enduro racer maken er
        TEST CH,CH                      ; gebruik van)
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (49 SHL 8)+02D
        SAHF
        stc
        rcl CL,1
        lahf
        TEST CL,CL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (50 SHL 8)+02D
        SAHF
        XCHG BX,SI
        stc
        rcl BH,1
        lahf
        TEST BH
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (51 SHL 8)+02D
        SAHF
        XCHG BX,SI
        stc
        rcl BL,1
        lahf
        TEST BL
        ror ah,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (52 SHL 8)+02D
        SAHF
        stc
        rcl DH,1
        lahf
        TEST DH,DH
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (53 SHL 8)+02D
        SAHF
        stc
        rcl DL,1
        lahf
        TEST DL,DL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (54 SHL 8)+02D
        sahf
        MOV BX,DX
        mov ah,[bx]
        stc
        rcl ah,1
        IF C JMP CARBX
        jmp pokebx

        testcboverf
        ORG (55 SHL 8)+02D
        SAHF
        stc
        rcl AL,1
        lahf
        TEST AL,AL
        ror ah,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (56 SHL 8)+02D
        SAHF
        SHR CH,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (57 SHL 8)+02D
        SAHF
        SHR CL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (58 SHL 8)+02D
        SAHF
        XCHG BX,SI
        SHR BH,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (59 SHL 8)+02D
        SAHF
        XCHG BX,SI
        SHR BL,1
        XCHG BX,SI
        LAHF
        jx_nolabel

        testcboverf
        ORG (60 SHL 8)+02D
        SAHF
        SHR DH,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (61 SHL 8)+02D
        SAHF
        SHR DL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (62 SHL 8)+02D
        mov bx,dx
        call testbx                     ; ***** HMc *****
        if nc jmp shrrom                ; ***** HMc *****
        SAHF
        mov ah,[bx]
        shr ah,1
        if c jmp carbx
        jmp pokebx

        testcboverf
        ORG (63 SHL 8)+02D
        SAHF
        SHR AL,1
        LAHF
        jx_nolabel

        testcboverf
        ORG (64 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CH,1
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (65 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CL,1
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (66 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,0100
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (67 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,1
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (68 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DH,1
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (69 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DL,1
finish_cb:
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (70 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,010
        TEST BYTE [BX],1
        jmp finish_cb
;        IF Z OR AH,044
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (71 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST AL,1
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (72 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CH,2
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (73 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CL,2
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (74 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,0200
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (75 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,2
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (76 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DH,2
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (77 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DL,2
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (78 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,010
        TEST BYTE [BX],2
        jmp finish_cb
;        IF Z OR AH,044
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (79 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST AL,2
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (80 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CH,4
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (81 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CL,4
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (82 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,0400
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (83 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,4
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (84 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DH,4
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (85 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DL,4
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (86 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,010
        TEST BYTE [BX],4
        jmp finish_cb
;        IF Z OR AH,044
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (87 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST AL,4
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (88 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST CH,8
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (89 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST CL,8
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (90 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST si,0800
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (91 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST si,8
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (92 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST DH,8
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (93 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST DL,8
finish_cb2:
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (94 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,018
        TEST BYTE [BX],8
        jmp finish_cb2
;        IF Z xOR AH,04c
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (95 SHL 8)+02D
        AND AH,001
        or ah,018
        TEST AL,8
        IF Z xOR AH,04c
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (96 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CH,16
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (97 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CL,16
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (98 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,01000
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (99 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,16
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (100 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DH,16
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (101 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DL,16
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (102 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,010
        TEST BYTE [BX],16
        jmp finish_cb
;        IF Z OR AH,044
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (103 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST AL,16
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (104 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST CH,32
        IF Z xoR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (105 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST CL,32
        IF Z xOR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (106 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST si,02000
        IF Z xOR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (107 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST si,32
        IF Z xOR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (108 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST DH,32
        IF Z xOR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (109 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST DL,32
finish_cb3:
        IF Z xOR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (110 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,030
        TEST BYTE [BX],32
        jmp finish_cb3
;        IF Z xOR AH,064
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (111 SHL 8)+02D
        AND AH,001
        or ah,030
        TEST AL,32
        IF Z xOR AH,064
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (112 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CH,64
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (113 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST CL,64
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (114 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,04000
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (115 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST si,64
        if z or ah,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (116 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DH,64
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (117 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST DL,64
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (118 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,010
        TEST BYTE [BX],64
        jmp finish_cb
;        IF Z OR AH,044
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (119 SHL 8)+02D
        AND AH,001
        or ah,010
        TEST AL,64
        IF Z OR AH,044
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (120 SHL 8)+02D
        AND AH,001              ;veranderd, wegens Sabre Wulf, adres AD86
        or ah,090               ;(zie ook file ddfd.8, label ddcb7d en ddcb7e)
        TEST CH,128
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (121 SHL 8)+02D
        AND AH,001
        or ah,090
        TEST CL,128
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (122 SHL 8)+02D
        AND AH,001
        or ah,090
        TEST si,08000
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (123 SHL 8)+02D
        AND AH,001
        or ah,090
        TEST si,080
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (124 SHL 8)+02D
        AND AH,001
        or ah,090
        TEST DH,128
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (125 SHL 8)+02D
        AND AH,001
        or ah,090
        TEST DL,128
finish_cb4:
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (126 SHL 8)+02D
        MOV BX,DX
        AND AH,001
        or ah,090
        TEST BYTE [BX],128
        jmp finish_cb4
;        IF Z xOR AH,0c4
;        mov es:temp_f,ah
;        jx_nolabel

        testcboverf
        ORG (127 SHL 8)+02D
        AND AH,001
        or ah,090
        TEST AL,128
        IF Z xOR AH,0c4
        mov es:temp_f,ah
        jx_nolabel

        testcboverf
        ORG (128 SHL 8)+02D
        AND CH,254
        jx_nolabel

        testcboverf
        ORG (129 SHL 8)+02D
        AND CL,254
        jx_nolabel

        testcboverf
        ORG (130 SHL 8)+02D
        XCHG BX,SI
        AND BH,254
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (131 SHL 8)+02D
        XCHG BX,SI
        AND BL,254
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (132 SHL 8)+02D
        AND DH,254
        jx_nolabel

        testcboverf
        ORG (133 SHL 8)+02D
        AND DL,254
        jx_nolabel

        testcboverf
        ORG (134 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],254
        jx_nolabel

        testcboverf
        ORG (135 SHL 8)+02D
        AND AL,254
        jx_nolabel

        testcboverf
        ORG (136 SHL 8)+02D
        AND CH,253
        jx_nolabel

        testcboverf
        ORG (137 SHL 8)+02D
        AND CL,253
        jx_nolabel

        testcboverf
        ORG (138 SHL 8)+02D
        XCHG BX,SI
        AND BH,253
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (139 SHL 8)+02D
        XCHG BX,SI
        AND BL,253
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (140 SHL 8)+02D
        AND DH,253
        jx_nolabel

        testcboverf
        ORG (141 SHL 8)+02D
        AND DL,253
        jx_nolabel

        testcboverf
        ORG (142 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],253
        jx_nolabel

        testcboverf
        ORG (143 SHL 8)+02D
        AND AL,253
        jx_nolabel

        testcboverf
        ORG (144 SHL 8)+02D
        AND CH,251
        jx_nolabel

        testcboverf
        ORG (145 SHL 8)+02D
        AND CL,251
        jx_nolabel

        testcboverf
        ORG (146 SHL 8)+02D
        XCHG BX,SI
        AND BH,251
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (147 SHL 8)+02D
        XCHG BX,SI
        AND BL,251
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (148 SHL 8)+02D
        AND DH,251
        jx_nolabel

        testcboverf
        ORG (149 SHL 8)+02D
        AND DL,251
        jx_nolabel

        testcboverf
        ORG (150 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],251
        jx_nolabel

        testcboverf
        ORG (151 SHL 8)+02D
        AND AL,251
        jx_nolabel

        testcboverf
        ORG (152 SHL 8)+02D
        AND CH,247
        jx_nolabel

        testcboverf
        ORG (153 SHL 8)+02D
        AND CL,247
        jx_nolabel

        testcboverf
        ORG (154 SHL 8)+02D
        XCHG BX,SI
        AND BH,247
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (155 SHL 8)+02D
        XCHG BX,SI
        AND BL,247
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (156 SHL 8)+02D
        AND DH,247
        jx_nolabel

        testcboverf
        ORG (157 SHL 8)+02D
        AND DL,247
        jx_nolabel

        testcboverf
        ORG (158 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],247
        jx_nolabel

        testcboverf
        ORG (159 SHL 8)+02D
        AND AL,247
        jx_nolabel

        testcboverf
        ORG (160 SHL 8)+02D
        AND CH,239
        jx_nolabel

        testcboverf
        ORG (161 SHL 8)+02D
        AND CL,239
        jx_nolabel

        testcboverf
        ORG (162 SHL 8)+02D
        XCHG BX,SI
        AND BH,239
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (163 SHL 8)+02D
        XCHG BX,SI
        AND BL,239
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (164 SHL 8)+02D
        AND DH,239
        jx_nolabel

        testcboverf
        ORG (165 SHL 8)+02D
        AND DL,239
        jx_nolabel

        testcboverf
        ORG (166 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],239
        jx_nolabel

        testcboverf
        ORG (167 SHL 8)+02D
        AND AL,239
        jx_nolabel

        testcboverf
        ORG (168 SHL 8)+02D
        AND CH,223
        jx_nolabel

        testcboverf
        ORG (169 SHL 8)+02D
        AND CL,223
        jx_nolabel

        testcboverf
        ORG (170 SHL 8)+02D
        XCHG BX,SI
        AND BH,223
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (171 SHL 8)+02D
        XCHG BX,SI
        AND BL,223
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (172 SHL 8)+02D
        AND DH,223
        jx_nolabel

        testcboverf
        ORG (173 SHL 8)+02D
        AND DL,223
        jx_nolabel

        testcboverf
        ORG (174 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],223
        jx_nolabel

        testcboverf
        ORG (175 SHL 8)+02D
        AND AL,223
        jx_nolabel

        testcboverf
        ORG (176 SHL 8)+02D
        AND CH,191
        jx_nolabel

        testcboverf
        ORG (177 SHL 8)+02D
        AND CL,191
        jx_nolabel

        testcboverf
        ORG (178 SHL 8)+02D
        XCHG BX,SI
        AND BH,191
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (179 SHL 8)+02D
        XCHG BX,SI
        AND BL,191
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (180 SHL 8)+02D
        AND DH,191
        jx_nolabel

        testcboverf
        ORG (181 SHL 8)+02D
        AND DL,191
        jx_nolabel

        testcboverf
        ORG (182 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],191
        jx_nolabel

        testcboverf
        ORG (183 SHL 8)+02D
        AND AL,191
        jx_nolabel

        testcboverf
        ORG (184 SHL 8)+02D
        AND CH,127
        jx_nolabel

        testcboverf
        ORG (185 SHL 8)+02D
        AND CL,127
        jx_nolabel

        testcboverf
        ORG (186 SHL 8)+02D
        XCHG BX,SI
        AND BH,127
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (187 SHL 8)+02D
        XCHG BX,SI
        AND BL,127
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (188 SHL 8)+02D
        AND DH,127
        jx_nolabel

        testcboverf
        ORG (189 SHL 8)+02D
        AND DL,127
        jx_nolabel

        testcboverf
        ORG (190 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c AND BYTE [BX],127
        jx_nolabel

        testcboverf
        ORG (191 SHL 8)+02D
        AND AL,127
        jx_nolabel

        testcboverf
        ORG (192 SHL 8)+02D
        OR CH,1
        jx_nolabel

        testcboverf
        ORG (193 SHL 8)+02D
        OR CL,1
        jx_nolabel

        testcboverf
        ORG (194 SHL 8)+02D
        XCHG BX,SI
        OR BH,1
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (195 SHL 8)+02D
        XCHG BX,SI
        OR BL,1
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (196 SHL 8)+02D
        OR DH,1
        jx_nolabel

        testcboverf
        ORG (197 SHL 8)+02D
        OR DL,1
        jx_nolabel

        testcboverf
        ORG (198 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],1
        jx_nolabel

        testcboverf
        ORG (199 SHL 8)+02D
        OR AL,1
        jx_nolabel

        testcboverf
        ORG (200 SHL 8)+02D
        OR CH,2
        jx_nolabel

        testcboverf
        ORG (201 SHL 8)+02D
        OR CL,2
        jx_nolabel

        testcboverf
        ORG (202 SHL 8)+02D
        XCHG BX,SI
        OR BH,2
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (203 SHL 8)+02D
        XCHG BX,SI
        OR BL,2
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (204 SHL 8)+02D
        OR DH,2
        jx_nolabel

        testcboverf
        ORG (205 SHL 8)+02D
        OR DL,2
        jx_nolabel

        testcboverf
        ORG (206 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],2
        jx_nolabel

        testcboverf
        ORG (207 SHL 8)+02D
        OR AL,2
        jx_nolabel

        testcboverf
        ORG (208 SHL 8)+02D
        OR CH,4
        jx_nolabel

        testcboverf
        ORG (209 SHL 8)+02D
        OR CL,4
        jx_nolabel

        testcboverf
        ORG (210 SHL 8)+02D
        XCHG BX,SI
        OR BH,4
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (211 SHL 8)+02D
        XCHG BX,SI
        OR BL,4
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (212 SHL 8)+02D
        OR DH,4
        jx_nolabel

        testcboverf
        ORG (213 SHL 8)+02D
        OR DL,4
        jx_nolabel

        testcboverf
        ORG (214 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],4
        jx_nolabel

        testcboverf
        ORG (215 SHL 8)+02D
        OR AL,4
        jx_nolabel

        testcboverf
        ORG (216 SHL 8)+02D
        OR CH,8
        jx_nolabel

        testcboverf
        ORG (217 SHL 8)+02D
        OR CL,8
        jx_nolabel

        testcboverf
        ORG (218 SHL 8)+02D
        XCHG BX,SI
        OR BH,8
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (219 SHL 8)+02D
        XCHG BX,SI
        OR BL,8
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (220 SHL 8)+02D
        OR DH,8
        jx_nolabel

        testcboverf
        ORG (221 SHL 8)+02D
        OR DL,8
        jx_nolabel

        testcboverf
        ORG (222 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],8
        jx_nolabel

        testcboverf
        ORG (223 SHL 8)+02D
        OR AL,8
        jx_nolabel

        testcboverf
        ORG (224 SHL 8)+02D
        OR CH,16
        jx_nolabel

        testcboverf
        ORG (225 SHL 8)+02D
        OR CL,16
        jx_nolabel

        testcboverf
        ORG (226 SHL 8)+02D
        XCHG BX,SI
        OR BH,16
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (227 SHL 8)+02D
        XCHG BX,SI
        OR BL,16
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (228 SHL 8)+02D
        OR DH,16
        jx_nolabel

        testcboverf
        ORG (229 SHL 8)+02D
        OR DL,16
        jx_nolabel

        testcboverf
        ORG (230 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],16
        jx_nolabel

        testcboverf
        ORG (231 SHL 8)+02D
        OR AL,16
        jx_nolabel

        testcboverf
        ORG (232 SHL 8)+02D
        OR CH,32
        jx_nolabel

        testcboverf
        ORG (233 SHL 8)+02D
        OR CL,32
        jx_nolabel

        testcboverf
        ORG (234 SHL 8)+02D
        XCHG BX,SI
        OR BH,32
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (235 SHL 8)+02D
        XCHG BX,SI
        OR BL,32
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (236 SHL 8)+02D
        OR DH,32
        jx_nolabel

        testcboverf
        ORG (237 SHL 8)+02D
        OR DL,32
        jx_nolabel

        testcboverf
        ORG (238 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],32
        jx_nolabel

        testcboverf
        ORG (239 SHL 8)+02D
        OR AL,32
        jx_nolabel

        testcboverf
        ORG (240 SHL 8)+02D
        OR CH,64
        jx_nolabel

        testcboverf
        ORG (241 SHL 8)+02D
        OR CL,64
        jx_nolabel

        testcboverf
        ORG (242 SHL 8)+02D
        XCHG BX,SI
        OR BH,64
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (243 SHL 8)+02D
        XCHG BX,SI
        OR BL,64
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (244 SHL 8)+02D
        OR DH,64
        jx_nolabel

        testcboverf
        ORG (245 SHL 8)+02D
        OR DL,64
        jx_nolabel

        testcboverf
        ORG (246 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],64
        jx_nolabel

        testcboverf
        ORG (247 SHL 8)+02D
        OR AL,64
        jx_nolabel

        testcboverf
        ORG (248 SHL 8)+02D
        OR CH,128
        jx_nolabel

        testcboverf
        ORG (249 SHL 8)+02D
        OR CL,128
        jx_nolabel

        testcboverf
        ORG (250 SHL 8)+02D
        XCHG BX,SI
        OR BH,128
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (251 SHL 8)+02D
        XCHG BX,SI
        OR BL,128
        XCHG BX,SI
        jx_nolabel

        testcboverf
        ORG (252 SHL 8)+02D
        OR DH,128
        jx_nolabel

        testcboverf
        ORG (253 SHL 8)+02D
        OR DL,128
        jx_nolabel

        testcboverf
        ORG (254 SHL 8)+02D
        MOV BX,DX
        call testbx
        if c OR BYTE [BX],128
        jx_nolabel

        testcboverf
        ORG (255 SHL 8)+02D
        OR AL,128
        jx_nolabel

        testcboverf
        ORG 0FFEF
        NOP


EMULATOR ENDS
